#ifndef HELICOPTER_MASTER_CONTROLLER_H
#define HELICOPTER_MASTER_CONTROLLER_H

// *******************************************************
// Thurs PM Group 23
//
// helicopterAltitude.h
//
// Used to store values from the altitude sensor inside a
// circular buffer. An interrupt is responsible for writing
// these values to the buffer. This file includes the
// functions to setup the interrupt and the interrupt
// functionality. This code is based on code supplied in
// the UC ENCE361 Lab4. The code inside Lab4 was written
// by P.J. Bones.
//
//  Authors:  Harry Dobbs, Sam Purdy, Sam Dunshea
//  Last modified: 25.4.2019
// 
// *******************************************************

#include <stdint.h>

// *******************************************************
// Buffer structure
typedef struct {
	uint32_t size;		// Number of entries in buffer
	uint32_t windex;	// index for writing, mod(size)
	uint32_t rindex;	// index for reading, mod(size)
	uint32_t *data;		// pointer to the data
} circBuf_t;

// *******************************************************
// initCircBuf: Initialise the circBuf instance. Reset both indices to
// the start of the buffer.  Dynamically allocate and clear the the 
// memory and return a pointer for the data.  Return NULL if 
// allocation fails.
uint32_t *
initCircBuf (circBuf_t *buffer, uint32_t size);

// *******************************************************
// writeCircBuf: insert entry at the current windex location,
// advance windex, modulo (buffer size).
void
writeCircBuf (circBuf_t *buffer, uint32_t entry);

// *******************************************************
// readCircBuf: return entry at the current rindex location,
// advance rindex, modulo (buffer size). The function deos not check
// if reading has advanced ahead of writing.
uint32_t
readCircBuf (circBuf_t *buffer);

// *******************************************************
// freeCircBuf: Releases the memory allocated to the buffer data,
// sets pointer to NULL and other fields to 0. The buffer can
// re initialised by another call to initCircBuf().
void
freeCircBuf (circBuf_t *buffer);

#endif /*HELICOPTER_MASTER_CONTROLLER_H*/
